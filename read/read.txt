**–õ–æ–≥–∏–∫–∞:**
1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (JSON —Ñ–æ—Ä–º–∞—Ç)
2. –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–∑ SQLite (–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—á–µ—Ä–µ–¥–∏)
3. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫:
   - `telegram.start_bot()` ‚Äî Webhook/polling
   - `email_monitor.check_loop()` ‚Äî IMAP —Ü–∏–∫–ª
   - `main_processing_loop()` ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª –æ–±—Ä–∞–±–æ—Ç–∫–∏
4. –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ (SIGINT, SIGTERM)
5. Graceful shutdown —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏—è

---

### 1.2 `orchestrator.main_processing_loop()`
**–ó–∞–¥–∞—á–∞:** –ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–¥–∞—á –∏–∑ –æ—á–µ—Ä–µ–¥–∏

**–õ–æ–≥–∏–∫–∞:**
```
WHILE is_running:
    IF is_paused:
        sleep(5)
        CONTINUE
    
    IF NOT check_rate_limits():
        sleep(60)
        CONTINUE
    
    issue_id = queue.get()
    
    IF issue_id is None:
        scan_for_new_issues()  # –ü–æ–∏—Å–∫ –Ω–æ–≤—ã—Ö bounty
        sleep(30)
        CONTINUE
    
    process_issue(issue_id)
```

---

### 1.3 `orchestrator.process_issue(issue_id)`
**–ó–∞–¥–∞—á–∞:** –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–¥–Ω–æ–≥–æ issue —á–µ—Ä–µ–∑ State Machine

**–õ–æ–≥–∏–∫–∞:**
1. –°–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ `StateMachine`
2. –ó–∞–ø—É—Å–∫ `state_machine.run()`
3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π (–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ TG)
4. –û—á–∏—Å—Ç–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è

---

### 1.4 `orchestrator.scan_for_new_issues()`
**–ó–∞–¥–∞—á–∞:** –ü–æ–∏—Å–∫ –Ω–æ–≤—ã—Ö issue —Å bounty –≤–æ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è—Ö

**–õ–æ–≥–∏–∫–∞:**
1. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ —á–µ—Ä–µ–∑ GitHub API
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–ø–æ:
   - GraphQL –∑–∞–ø—Ä–æ—Å: –æ—Ç–∫—Ä—ã—Ç—ã–µ issue —Å –º–µ—Ç–∫–∞–º–∏ `[bounty, reward, $, paid, RTC]`
   - –î–ª—è –∫–∞–∂–¥–æ–≥–æ issue: AI –∞–Ω–∞–ª–∏–∑ —Ç–µ–∫—Å—Ç–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Å—É–º–º—ã (`$500`, `USD 100`)
   - –ï—Å–ª–∏ bounty –æ–±–Ω–∞—Ä—É–∂–µ–Ω: —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –≤ –ë–î (status=PENDING)
   - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ PriorityQueue
3. **–ù–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** ‚Äî —Ç–∏—Ö–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –æ—á–µ—Ä–µ–¥—å

---

### 1.5 `orchestrator.check_rate_limits()`
**–ó–∞–¥–∞—á–∞:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤ –≤—Å–µ—Ö API –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–±–æ—Ç—ã

**–õ–æ–≥–∏–∫–∞:**
1. GitHub API: `get_rate_limit()` ‚Üí –µ—Å–ª–∏ < 100, `notify_rate_limit()` ‚Üí return False
2. OpenAI API: `get_rate_limit()` ‚Üí –µ—Å–ª–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π, `notify_critical()` ‚Üí `stop()` ‚Üí return False
3. Docker: `ping()` ‚Üí –µ—Å–ª–∏ –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç, `ensure_running()` ‚Üí –µ—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å, return False
4. Return True (–≤—Å–µ —Å–∏—Å—Ç–µ–º—ã –≥–æ—Ç–æ–≤—ã)

---

### 1.6 `orchestrator.cmd_pause()`
**–ó–∞–¥–∞—á–∞:** –ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏

**–õ–æ–≥–∏–∫–∞:**
1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ñ–ª–∞–≥–∞ `is_paused = True`
2. –û—Ç–º–µ–Ω–∞ —Ç–µ–∫—É—â–µ–π –∑–∞–¥–∞—á–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å) —á–µ—Ä–µ–∑ `task.cancel()`
3. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ç–µ–∫—É—â–µ–π –∑–∞–¥–∞—á–∏ –≤ –ë–î
4. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Telegram: "–ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞"

---

### 1.7 `orchestrator.cmd_resume()`
**–ó–∞–¥–∞—á–∞:** –í–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏

**–õ–æ–≥–∏–∫–∞:**
1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ñ–ª–∞–≥–∞ `is_paused = False`
2. –ü—Ä–æ–≤–µ—Ä–∫–∞ `check_rate_limits()`
3. –í–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ `main_processing_loop()`
4. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Telegram: "–ü—Ä–æ–≥—Ä–∞–º–º–∞ –≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∞"

---

### 1.8 `orchestrator.cmd_status()`
**–ó–∞–¥–∞—á–∞:** –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —Å—Ç–∞—Ç—É—Å–∞ —Å–∏—Å—Ç–µ–º—ã

**–õ–æ–≥–∏–∫–∞:**
1. –ó–∞–ø—Ä–æ—Å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏–∑ –ë–î:
   - PENDING: `count(status='pending')`
   - ACTIVE: `count(status in [fetching, analyzing, coding, testing])`
   - COMPLETED: `count(status='completed')`
   - FAILED: `count(status='failed')`
2. –ü–æ–ª—É—á–µ–Ω–∏–µ rate limits –æ—Ç –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
3. –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫—Ä–∞—Å–∏–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è Telegram
4. Return —Å—Ç—Ä–æ–∫–∞ —Å Markdown —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º

---

### 1.9 `orchestrator.cmd_settings(**kwargs)`
**–ó–∞–¥–∞—á–∞:** –ò–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –Ω–∞ –ª–µ—Ç—É

**–õ–æ–≥–∏–∫–∞:**
1. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
   - `model`: "gpt-4" –∏–ª–∏ "claude-3" ‚Üí `ai_provider.set_model()`
   - `max_time`: int ‚Üí `docker_sandbox.timeout = value`
   - `docker_cpu`: int ‚Üí `docker_sandbox.cpu_tier = value`
2. –í–∞–ª–∏–¥–∞—Ü–∏—è –∑–Ω–∞—á–µ–Ω–∏–π
3. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ `.env` –∏–ª–∏ –ë–î
4. Return –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

---

## 2. STATE MACHINE (–ö–æ–Ω–µ—á–Ω—ã–π –∞–≤—Ç–æ–º–∞—Ç)

### 2.1 `state_machine.run()`
**–ó–∞–¥–∞—á–∞:** –ì–ª–∞–≤–Ω—ã–π —Ü–∏–∫–ª —Å–æ—Å—Ç–æ—è–Ω–∏–π –¥–ª—è –æ–¥–Ω–æ–≥–æ issue

**–õ–æ–≥–∏–∫–∞:**
```
WHILE current_state != COMPLETED:
    SWITCH current_state:
        CASE IDLE: transition_to(FETCHING)
        CASE FETCHING: do_fetching()
        CASE ANALYZING: do_analyzing()
        CASE CODING: do_coding()
        CASE TESTING: do_testing()
        CASE CREATING_PR: do_creating_pr()
        CASE FAILED: do_failed(); BREAK
    
    IF state_changed:
        save_checkpoint()
```

---

### 2.2 `state_machine.transition_to(new_state)`
**–ó–∞–¥–∞—á–∞:** –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –º–µ–∂–¥—É —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏

**–õ–æ–≥–∏–∫–∞:**
1. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ: `logger.info(f"{old} ‚Üí {new}")`
2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `current_state = new_state`
3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `issue.status` –≤ –ë–î (–º–∞–ø–ø–∏–Ω–≥ enum)
4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `issue.updated_at = now()`
5. Commit –≤ SQLite

---

### 2.3 `state_machine.do_fetching()`
**–ó–∞–¥–∞—á–∞:** –°–±–æ—Ä –≤—Å–µ—Ö –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è issue

**–õ–æ–≥–∏–∫–∞:**
1. `docker.ensure_running()` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞/–∑–∞–ø—É—Å–∫ Docker
2. `github.get_issue(repo, number)` ‚Äî –±–∞–∑–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ issue
3. `github.get_linked_issues(repo, number, depth=2)` ‚Äî —Å–≤—è–∑–∞–Ω–Ω—ã–µ A+B
4. `github.get_linked_prs(repo, number)` ‚Äî —Å–≤—è–∑–∞–Ω–Ω—ã–µ PR —Å –∫–æ–¥–æ–º
5. `content_api.download_files(file_paths)` ‚Äî —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ <100MB
6. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞:** –µ—Å–ª–∏ —Ñ–∞–π–ª >100MB ‚Üí `add_to_blacklist("file_too_large")` ‚Üí `transition_to(FAILED)`
7. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ `checkpoint_data['files']`, `checkpoint_data['linked']`
8. `transition_to(ANALYZING)`

**–ò—Å–∫–ª—é—á–µ–Ω–∏—è:**
- `GitHubAPIError` ‚Üí `retry_or_fail("fetching", error)`
- `FileTooLarge` ‚Üí `add_to_blacklist()` ‚Üí `transition_to(FAILED)`

---

### 2.4 `state_machine.do_analyzing()`
**–ó–∞–¥–∞—á–∞:** AI –∞–Ω–∞–ª–∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è

**–õ–æ–≥–∏–∫–∞:**
1. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞:
   - Issue title + body
   - Linked issues (A+B) ‚Äî –∏—Ö –æ–ø–∏—Å–∞–Ω–∏—è
   - Linked PR ‚Äî –∫–æ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏–π
   - –¢–µ–∫—É—â–∏–π –∫–æ–¥ —Ñ–∞–π–ª–æ–≤
2. `ai.generate(prompt, model=current_model)` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ analysis
3. –ü–∞—Ä—Å–∏–Ω–≥ –æ—Ç–≤–µ—Ç–∞ AI:
   - `analysis['problem']` ‚Äî –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã
   - `analysis['solution_plan']` ‚Äî —à–∞–≥–∏ —Ä–µ—à–µ–Ω–∏—è
   - `analysis['files_to_modify']` ‚Äî —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤
   - `analysis['estimated_complexity']` ‚Äî —Å–ª–æ–∂–Ω–æ—Å—Ç—å (1-10)
4. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ `checkpoint_data['analysis']`
5. `transition_to(CODING)`

**–ò—Å–∫–ª—é—á–µ–Ω–∏—è:**
- `AIError` ‚Üí `retry_or_fail("analyzing", error)`

---

### 2.5 `state_machine.do_coding()`
**–ó–∞–¥–∞—á–∞:** –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ —Ä–µ—à–µ–Ω–∏—è

**–õ–æ–≥–∏–∫–∞:**
1. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:
   - Solution plan –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —à–∞–≥–∞
   - –¢–µ–∫—É—â–∏–π –∫–æ–¥ —Ñ–∞–π–ª–æ–≤
   - –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è: "Generate complete, working code"
2. `code_generator.generate_solution(analysis, files)` ‚Äî –≤—ã–∑–æ–≤ AI
3. –ü–∞—Ä—Å–∏–Ω–≥ –æ—Ç–≤–µ—Ç–∞:
   - `generated_code[file_path] = content`
   - `commit_message = generated['message']`
4. **Security scan:** `security_scan(generated_code)`
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤: `rm -rf`, `System.exit`, `os.system`, etc.
   - –ï—Å–ª–∏ CRITICAL –Ω–∞–π–¥–µ–Ω ‚Üí `add_to_blacklist("security_violation")` ‚Üí `transition_to(FAILED)`
5. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ `checkpoint_data['generated_code']`, `checkpoint_data['commit_message']`
6. `transition_to(TESTING)`

---

### 2.6 `state_machine.do_testing()`
**–ó–∞–¥–∞—á–∞:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞ –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–º Docker

**–õ–æ–≥–∏–∫–∞:**
1. –†–∞—Å—á—ë—Ç —Ä–µ—Å—É—Ä—Å–æ–≤:
   - `code_size = sum(len(c) for c in generated_code.values())`
   - `cpu_tier = 2 if code_size < 1000 else (4 if code_size < 5000 else 6)`
   - `memory = 512 + sum(len(c.encode()) for c in generated_code.values()) / 10240` (MB)
2. `docker.run_test(...)`:
   - –°–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
   - –ó–∞–ø–∏—Å—å —Ñ–∞–π–ª–æ–≤
   - –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Å `network=none`, `read_only=True`
   - –¢–∞–π–º–∞—É—Ç 25 —Å–µ–∫—É–Ω–¥
   - –û–∂–∏–¥–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
3. –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:
   - `exit_code == 0` ‚Üí `transition_to(CREATING_PR)`
   - `exit_code != 0` –∏–ª–∏ timeout ‚Üí `retry_or_fail("testing", error)`
4. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ª–æ–≥–æ–≤ —Ç–µ—Å—Ç–∞ –≤ `checkpoint_data`

---

### 2.7 `state_machine.do_creating_pr()`
**–ó–∞–¥–∞—á–∞:** –°–æ–∑–¥–∞–Ω–∏–µ Pull Request –Ω–∞ GitHub

**–õ–æ–≥–∏–∫–∞:**
1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–º–µ–Ω–∏ –≤–µ—Ç–∫–∏: `ai/{issue_number}/{timestamp}`
2. `github.create_branch(repo, base_branch, new_branch)` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –≤–µ—Ç–∫–∏
3. `github.create_commit(...)`:
   - –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–º–µ–Ω—ë–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
   - –ö–æ–º–º–∏—Ç —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º –æ—Ç AI
4. `github.create_pull_request(...)`:
   - Title: "AI Fix: {issue_title}"
   - Body: —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ + —Å—Å—ã–ª–∫–∏
   - Head: –Ω–æ–≤–∞—è –≤–µ—Ç–∫–∞, Base: main
5. `github.comment_on_issue(...)` ‚Äî –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å —Å—Å—ã–ª–∫–æ–π –Ω–∞ PR
6. –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –≤ `pull_requests` —Ç–∞–±–ª–∏—Ü–µ
7. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Telegram:** `notify_pr_created()`
8. `transition_to(COMPLETED)`

**–ò—Å–∫–ª—é—á–µ–Ω–∏—è:**
- `GitHubAPIError` ‚Üí `retry_or_fail("creating_pr", error)`

---

### 2.8 `state_machine.retry_or_fail(stage, error)`
**–ó–∞–¥–∞—á–∞:** –†–µ—à–µ–Ω–∏–µ: –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –∏–ª–∏ –ø—Ä–∏–∑–Ω–∞—Ç—å –Ω–µ—É–¥–∞—á—É

**–õ–æ–≥–∏–∫–∞:**
1. `attempt_count += 1`
2. –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –≤ `attempts`:
   - `attempt_number = attempt_count`
   - `status = error_type`
   - `error_message = str(error)`
   - `error_traceback = traceback`
3. **IF** `attempt_count >= 3`:
   - `add_to_blacklist(f"Failed after 3 attempts at {stage}")`
   - `transition_to(FAILED)`
4. **ELSE**:
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ: `logger.info(f"Retry {attempt_count}/3")`
   - `transition_to(CODING)` ‚Äî –≤–æ–∑–≤—Ä–∞—Ç –∫ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –æ—à–∏–±–∫–∏
   - –í –ø—Ä–æ–º–ø—Ç –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è: "Previous attempt failed with: {error}. Fix this issue."

---

### 2.9 `state_machine.add_to_blacklist(reason)`
**–ó–∞–¥–∞—á–∞:** –ü–µ—Ä–º–∞–Ω–µ–Ω—Ç–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ issue

**–õ–æ–≥–∏–∫–∞:**
1. `issue.is_blacklisted = True`
2. `issue.blacklist_reason = reason`
3. –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –≤ `blacklist` —Ç–∞–±–ª–∏—Ü–µ:
   - `issue_id`, `reason`, `added_by="auto"`, `is_permanent=True`
4. `issue.status = BLACKLISTED`
5. Commit –≤ –ë–î
6. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ: `logger.warning(f"Blacklisted issue {issue_id}: {reason}")`

---

### 2.10 `state_machine.save_checkpoint()`
**–ó–∞–¥–∞—á–∞:** –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è

**–õ–æ–≥–∏–∫–∞:**
1. –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è `checkpoint_data` –≤ JSON
2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `issue.checkpoint_data = json`
3. Commit –≤ –ë–î
4. –ü—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏: –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —à–∞–≥–∞

---

## 3. GITHUB MODULE (–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å GitHub)

### 3.1 `github_client.get_rate_limit()`
**–ó–∞–¥–∞—á–∞:** –ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –ª–∏–º–∏—Ç–æ–≤ API

**–õ–æ–≥–∏–∫–∞:**
1. REST API: `GET /rate_limit`
2. –ü–∞—Ä—Å–∏–Ω–≥ `resources.core.remaining`, `resources.core.reset`
3. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ `rate_limit_logs`
4. Return `remaining` (int)

---

### 3.2 `github_client.get_issue(repo, number)`
**–ó–∞–¥–∞—á–∞:** –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö issue

**–õ–æ–≥–∏–∫–∞:**
1. REST API: `GET /repos/{repo}/issues/{number}`
2. –ü–∞—Ä—Å–∏–Ω–≥ JSON: title, body, state, labels, created_at, etc.
3. Return dict

---

### 3.3 `github_client.search_issues(repo, labels, state='open')`
**–ó–∞–¥–∞—á–∞:** –ü–æ–∏—Å–∫ issue –ø–æ –º–µ—Ç–∫–∞–º

**–õ–æ–≥–∏–∫–∞:**
1. GraphQL –∑–∞–ø—Ä–æ—Å:
   ```graphql
   query {
     repository(owner, name) {
       issues(labels: [...], states: OPEN, first: 100) {
         nodes { id, number, title, body, labels { name } }
       }
     }
   }
   ```
2. –ü–∞—Ä—Å–∏–Ω–≥ –æ—Ç–≤–µ—Ç–∞
3. Return list of issues

---

### 3.4 `github_client.get_linked_issues(repo, number, depth=2)`
**–ó–∞–¥–∞—á–∞:** –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö issue (–≥–ª—É–±–∏–Ω–∞ A+B)

**–õ–æ–≥–∏–∫–∞:**
1. GraphQL: –ø–æ–ª—É—á–∏—Ç—å `closingIssuesReferences` –¥–ª—è PR, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å issue
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ linked issue (depth 1):
   - –ü–æ–ª—É—á–∏—Ç—å –µ–≥–æ `closingIssuesReferences` (depth 2)
3. –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö unique issue IDs
4. Return `{'issues': [...], 'pull_requests': [...]}`

---

### 3.5 `github_client.get_linked_prs(repo, number)`
**–ó–∞–¥–∞—á–∞:** –ü–æ–ª—É—á–µ–Ω–∏–µ PR, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å issue, –∏ –∏—Ö –∫–æ–¥

**–õ–æ–≥–∏–∫–∞:**
1. GraphQL: `timelineItems(itemTypes: [CROSS_REFERENCED_EVENT])`
2. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è: —Ç–æ–ª—å–∫–æ PR (–Ω–µ issue)
3. –î–ª—è –∫–∞–∂–¥–æ–≥–æ PR: –ø–æ–ª—É—á–∏—Ç—å `files` (changed files)
4. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞: –ø–æ–ª—É—á–∏—Ç—å `diff` –∏–ª–∏ –ø–æ–ª–Ω—ã–π –∫–æ–¥ —á–µ—Ä–µ–∑ Content API
5. Return `{'pr_number': {'files': {'path': 'diff'}}}`

---

### 3.6 `content_api.download_files(file_paths, max_size=100MB)`
**–ó–∞–¥–∞—á–∞:** –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ Content API

**–õ–æ–≥–∏–∫–∞:**
1. –î–ª—è –∫–∞–∂–¥–æ–≥–æ `file_path`:
   - `GET /repos/{repo}/contents/{path}`
   - –ü–æ–ª—É—á–µ–Ω–∏–µ `download_url` –∏–ª–∏ `content` (base64)
   - –î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ base64
   - **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞:** `len(content) > 100MB` ‚Üí raise `FileTooLarge`
2. Return `{'path': 'content'}`

---

### 3.7 `pr_manager.create_branch(repo, base, new_branch)`
**–ó–∞–¥–∞—á–∞:** –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –≤–µ—Ç–∫–∏

**–õ–æ–≥–∏–∫–∞:**
1. –ü–æ–ª—É—á–µ–Ω–∏–µ SHA –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∫–æ–º–º–∏—Ç–∞ base –≤–µ—Ç–∫–∏: `GET /repos/{repo}/git/refs/heads/{base}`
2. –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –≤–µ—Ç–∫–∏: `POST /repos/{repo}/git/refs`
   - `ref: refs/heads/{new_branch}`
   - `sha: base_sha`
3. Return branch name

---

### 3.8 `pr_manager.create_commit(repo, branch, files, message)`
**–ó–∞–¥–∞—á–∞:** –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–º–∏—Ç–∞ —Å –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏

**–õ–æ–≥–∏–∫–∞:**
1. –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –¥–µ—Ä–µ–≤–∞: `GET /repos/{repo}/git/refs/heads/{branch}`
2. –°–æ–∑–¥–∞–Ω–∏–µ blob –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞: `POST /repos/{repo}/git/blobs`
3. –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –¥–µ—Ä–µ–≤–∞: `POST /repos/{repo}/git/trees`
4. –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–º–∏—Ç–∞: `POST /repos/{repo}/git/commits`
5. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ ref –≤–µ—Ç–∫–∏: `PATCH /repos/{repo}/git/refs/heads/{branch}`
6. Return commit SHA

---

### 3.9 `pr_manager.create_pull_request(repo, title, body, head, base)`
**–ó–∞–¥–∞—á–∞:** –°–æ–∑–¥–∞–Ω–∏–µ Pull Request

**–õ–æ–≥–∏–∫–∞:**
1. REST API: `POST /repos/{repo}/pulls`
   - `title`, `body`, `head`, `base`
2. –ü–∞—Ä—Å–∏–Ω–≥ –æ—Ç–≤–µ—Ç–∞: –ø–æ–ª—É—á–µ–Ω–∏–µ `number`, `html_url`
3. Return PR data dict

---

### 3.10 `comment_manager.comment_on_issue(repo, number, body)`
**–ó–∞–¥–∞—á–∞:** –ö–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ issue

**–õ–æ–≥–∏–∫–∞:**
1. REST API: `POST /repos/{repo}/issues/{number}/comments`
2. Return comment ID

---

## 4. AI MODULE (–ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç)

### 4.1 `ai_provider.set_model(model_name)`
**–ó–∞–¥–∞—á–∞:** –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ AI

**–õ–æ–≥–∏–∫–∞:**
1. –í–∞–ª–∏–¥–∞—Ü–∏—è: `model_name in ['gpt-4', 'claude-3']`
2. `current_model = model_name`
3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ API client (OpenAI –∏–ª–∏ Anthropic)
4. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è

---

### 4.2 `ai_provider.get_rate_limit()`
**–ó–∞–¥–∞—á–∞:** –ü–æ–ª—É—á–µ–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤ —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞

**–õ–æ–≥–∏–∫–∞:**
1. –î–ª—è OpenAI: `GET /v1/dashboard/billing/subscription` –∏–ª–∏ header `x-ratelimit-remaining`
2. –î–ª—è Claude: –∞–Ω–∞–ª–∏–∑ headers –æ—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
3. Return `{'remaining': int, 'reset_at': datetime}`

---

### 4.3 `ai_provider.generate(prompt, max_tokens, temperature=0.2)`
**–ó–∞–¥–∞—á–∞:** –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ —á–µ—Ä–µ–∑ AI

**–õ–æ–≥–∏–∫–∞:**
1. –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è —Ç–µ–∫—É—â–µ–π –º–æ–¥–µ–ª–∏
2. API call —Å retry (3 –ø–æ–ø—ã—Ç–∫–∏ –ø—Ä–∏ rate limit)
3. –ü–æ–¥—Å—á—ë—Ç —Ç–æ–∫–µ–Ω–æ–≤: input + output
4. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ `analytics` (—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)
5. Return generated text

---

### 4.4 `ai_provider.detect_bounty(text)`
**–ó–∞–¥–∞—á–∞:** AI –∞–Ω–∞–ª–∏–∑ —Ç–µ–∫—Å—Ç–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏—è

**–õ–æ–≥–∏–∫–∞:**
1. –ü—Ä–æ–º–ø—Ç: "Analyze this GitHub issue text. Does it mention bounty/reward/payment? Extract amount in USD."
2. AI –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω—ã: `$500`, `100 USD`, `reward: $50`, etc.
3. Return `(has_bounty: bool, amount: float or None)`

---

### 4.5 `prompt_engineer.build_analysis_prompt(issue, linked_issues, linked_prs, files)`
**–ó–∞–¥–∞—á–∞:** –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ issue

**–õ–æ–≥–∏–∫–∞:**
1. –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:
   - Issue: title, body
   - Linked: —Å–ø–∏—Å–æ–∫ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö issue —Å –æ–ø–∏—Å–∞–Ω–∏—è–º–∏
   - PRs: –∫–æ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏–∑ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö PR
   - Files: —Ç–µ–∫—É—â–∏–π –∫–æ–¥
2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π: "Analyze the problem, understand context from linked issues, propose solution plan"
3. Return formatted string

---

### 4.6 `prompt_engineer.build_code_prompt(analysis, files)`
**–ó–∞–¥–∞—á–∞:** –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–¥–∞

**–õ–æ–≥–∏–∫–∞:**
1. –í–∫–ª—é—á–µ–Ω–∏–µ `analysis['solution_plan']`
2. –í–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –∫–æ–¥–∞ `files`
3. –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏: "Generate complete, working code. Include all necessary changes. Do not use os.system, Runtime.exec, or similar dangerous functions."
4. Return formatted string

---

### 4.7 `code_generator.generate_solution(analysis, files)`
**–ó–∞–¥–∞—á–∞:** –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ—à–µ–Ω–∏—è —á–µ—Ä–µ–∑ AI

**–õ–æ–≥–∏–∫–∞:**
1. `prompt = prompt_engineer.build_code_prompt(analysis, files)`
2. `response = ai_provider.generate(prompt, max_tokens=4000)`
3. –ü–∞—Ä—Å–∏–Ω–≥ –æ—Ç–≤–µ—Ç–∞:
   - –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ —Ñ–∞–π–ª—ã (–µ—Å–ª–∏ AI –≤–µ—Ä–Ω—É–ª markdown blocks)
   - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ commit message
4. Return `{'code': {'path': 'content'}, 'commit_message': 'str'}`

---

### 4.8 `code_generator.generate_commit_message(changes)`
**–ó–∞–¥–∞—á–∞:** –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Å–º—ã—Å–ª–µ–Ω–Ω–æ–≥–æ commit message

**–õ–æ–≥–∏–∫–∞:**
1. –ü—Ä–æ–º–ø—Ç: "Based on these code changes, write a concise, conventional commit message (max 72 chars)"
2. AI –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç: `type: description` (fix:, feat:, refactor:)
3. Return message string

---

### 4.9 `output_validator.validate_code(code)`
**–ó–∞–¥–∞—á–∞:** –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—ã—Ö–æ–¥–∞ AI

**–õ–æ–≥–∏–∫–∞:**
1. –ü—Ä–æ–≤–µ—Ä–∫–∞: –≤—Å–µ —Ñ–∞–π–ª—ã –∏–∑ `analysis['files_to_modify']` –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç
2. –ü—Ä–æ–≤–µ—Ä–∫–∞: –∫–æ–¥ –Ω–µ –ø—É—Å—Ç–æ–π, —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π (basic)
3. Return `(is_valid: bool, errors: list)`

---

## 5. DOCKER MODULE (–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è)

### 5.1 `docker_sandbox.ensure_running()`
**–ó–∞–¥–∞—á–∞:** –ì–∞—Ä–∞–Ω—Ç–∏—è –∑–∞–ø—É—â–µ–Ω–Ω–æ–≥–æ Docker Desktop

**–õ–æ–≥–∏–∫–∞:**
1. –ü–æ–ø—ã—Ç–∫–∞ `docker.from_env().ping()`
2. **IF** —É—Å–ø–µ—Ö: return True
3. **IF** –æ—à–∏–±–∫–∞ AND Windows:
   - –ü–æ–∏—Å–∫ `Docker Desktop.exe` –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –ø—É—Ç—è—Ö
   - `subprocess.Popen([path])` ‚Äî –∑–∞–ø—É—Å–∫
   - –¶–∏–∫–ª –æ–∂–∏–¥–∞–Ω–∏—è: 60 –ø–æ–ø—ã—Ç–æ–∫ —Å sleep(1)
   - –ü–æ–≤—Ç–æ—Ä–Ω—ã–π `ping()`
4. **IF** –Ω–µ —É–¥–∞–ª–æ—Å—å: raise `DockerError`

---

### 5.2 `docker_sandbox.calculate_resources(code_size, file_count)`
**–ó–∞–¥–∞—á–∞:** –†–∞—Å—á—ë—Ç —Ä–µ—Å—É—Ä—Å–æ–≤ –ø–æ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Å—Ç—É–ø–µ–Ω—è–º

**–õ–æ–≥–∏–∫–∞:**
```
lines = code_size / 50  # –ø—Ä–∏–º–µ—Ä–Ω–æ 50 —Å–∏–º–≤–æ–ª–æ–≤ –Ω–∞ —Å—Ç—Ä–æ–∫—É

IF lines < 1000:
    cpu = 2
ELIF lines < 5000:
    cpu = 4
ELSE:
    cpu = 6

ram_mb = 512 + (code_size / 1024) / 10  # 512 + KB/10

Return {'cpu': cpu, 'memory': f'{int(ram_mb)}m'}
```

---

### 5.3 `docker_sandbox.security_scan(code)`
**–ó–∞–¥–∞—á–∞:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞ –Ω–∞ –æ–ø–∞—Å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

**–õ–æ–≥–∏–∫–∞:**
1. –°–ø–∏—Å–æ–∫ –∑–∞–ø—Ä–µ—â—ë–Ω–Ω—ã—Ö regex –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤:
   - `rm\s+-rf\s+/`
   - `System\.exit\s*\(`
   - `Runtime\.exec\s*\(`
   - `os\.system\s*\(`
   - `subprocess\.call.*shell=True`
   - `eval\s*\(`
   - `exec\s*\(`
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞: –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
3. Return `list of violations` (–ø—É—Å—Ç–æ–π –µ—Å–ª–∏ —á–∏—Å—Ç–æ)

---

### 5.4 `docker_sandbox.run_test(code, language, cpu, memory, timeout=25)`
**–ó–∞–¥–∞—á–∞:** –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∞ –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ

**–õ–æ–≥–∏–∫–∞:**
1. –°–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ (`tempfile.TemporaryDirectory`)
2. –ó–∞–ø–∏—Å—å —Ñ–∞–π–ª–æ–≤ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
3. –í—ã–±–æ—Ä –æ–±—Ä–∞–∑–∞: `python:3.11-slim` –∏–ª–∏ `openjdk:17-slim`
4. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã:
   - Python: `python {main_file}`
   - Java: `javac {files} && java Main`
5. –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:
   - `docker.containers.run(...)`
   - `resources=Resources(cpu_count=cpu, mem_limit=memory)`
   - `network_mode='none'`
   - `volumes={tmpdir: {'bind': '/code', 'mode': 'ro'}}`
   - `detach=True`
6. `container.wait(timeout=25)`
7. –ü–æ–ª—É—á–µ–Ω–∏–µ –ª–æ–≥–æ–≤: `container.logs()`
8. –û—á–∏—Å—Ç–∫–∞: `container.remove(force=True)`
9. Return `{'success': exit_code==0, 'output': logs, 'duration': seconds}`

---

### 5.5 `docker_sandbox.cleanup()`
**–ó–∞–¥–∞—á–∞:** –û—á–∏—Å—Ç–∫–∞ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

**–õ–æ–≥–∏–∫–∞:**
1. `docker.containers.list(all=True, filters={'status': 'exited'})`
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ: `container.remove(force=True)`
3. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —É–¥–∞–ª—ë–Ω–Ω—ã—Ö

---

## 6. TELEGRAM MODULE (–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ)

### 6.1 `telegram_bot.start_bot(orchestrator)`
**–ó–∞–¥–∞—á–∞:** –ó–∞–ø—É—Å–∫ Telegram –±–æ—Ç–∞

**–õ–æ–≥–∏–∫–∞:**
1. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ `orchestrator`
2. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤—Å–µ—Ö handlers (commands, callbacks)
3. `aiogram` polling: `dp.start_polling(bot)`
4. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

---

### 6.2 `telegram_bot.get_main_menu_keyboard()`
**–ó–∞–¥–∞—á–∞:** –°–æ–∑–¥–∞–Ω–∏–µ –≥–ª–∞–≤–Ω–æ–π –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã

**–õ–æ–≥–∏–∫–∞:**
1. `InlineKeyboardBuilder()`
2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫:
   - Row 1: [üöÄ –°—Ç–∞—Ç—É—Å] [‚è∏ –ü–∞—É–∑–∞] [‚ñ∂ –°—Ç–∞—Ä—Ç]
   - Row 2: [üìã –û—á–µ—Ä–µ–¥—å] [‚öô –ù–∞—Å—Ç—Ä–æ–π–∫–∏]
   - Row 3: [üö´ Blacklist] [üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞]
3. Return `InlineKeyboardMarkup`

---

### 6.3 `telegram_bot.notify_pr_created(issue, pr_url, bounty)`
**–ó–∞–¥–∞—á–∞:** –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Å–æ–∑–¥–∞–Ω–Ω–æ–º PR

**–õ–æ–≥–∏–∫–∞:**
1. –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è:
   ```
   ‚úÖ PR –°–æ–∑–¥–∞–Ω!
   Issue: #{number}
   –°—É–º–º–∞: ${bounty}
   {pr_url}
   ```
2. `bot.send_message(chat_id, text, parse_mode='HTML')`
3. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `telegram_logs`

---

### 6.4 `telegram_bot.notify_pr_merged(pr, issue, translated_text, original_body)`
**–ó–∞–¥–∞—á–∞:** –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ merged PR —Å –∫–Ω–æ–ø–∫–∞–º–∏ –¥–µ–π—Å—Ç–≤–∏–π

**–õ–æ–≥–∏–∫–∞:**
1. –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
   ```
   üéâ PR #{number} —É—Å–ø–µ—à–Ω–æ merged!
   –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: {repo}
   –°—É–º–º–∞: ${bounty}
   
   –ü–µ—Ä–µ–≤–æ–¥ –ø–∏—Å—å–º–∞:
   {translated_text}
   ```
2. –°–æ–∑–¥–∞–Ω–∏–µ –∫–Ω–æ–ø–æ–∫:
   - `[üîç –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å]` callback: `analyze:{pr_id}`
   - `[üóë –£–¥–∞–ª–∏—Ç—å]` callback: `delete:{pr_id}`
   - `[üöÄ –°—Ç–∞—Ç—É—Å]` callback: `status`
   - `[‚è∏ –ü–∞—É–∑–∞]` –∏–ª–∏ `[‚ñ∂ –°—Ç–∞—Ä—Ç]` (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç `orchestrator.is_paused`)
   - `[‚öô –ù–∞—Å—Ç—Ä–æ–π–∫–∏]` callback: `settings`
3. –û—Ç–ø—Ä–∞–≤–∫–∞ —Å `reply_markup`

---

### 6.5 `telegram_bot.cb_analyze_pr(callback)`
**–ó–∞–¥–∞—á–∞:** –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏ "–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å"

**–õ–æ–≥–∏–∫–∞:**
1. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ `pr_id` –∏–∑ callback data
2. –ü–æ–ª—É—á–µ–Ω–∏–µ PR –∏–∑ –ë–î
3. –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–¥–∞ PR: `github.get_pr_files()`
4. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞: "Analyze this merged PR. What could be improved? Suggest new criteria."
5. `ai.generate(prompt)`
6. –û—Ç–ø—Ä–∞–≤–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å –∫–Ω–æ–ø–∫–æ–π "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å insights"
7. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ insights –≤ –ë–î (`pr_insights` —Ç–∞–±–ª–∏—Ü–∞)

---

### 6.6 `telegram_bot.cb_delete_pr(callback)`
**–ó–∞–¥–∞—á–∞:** –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏ "–£–¥–∞–ª–∏—Ç—å"

**–õ–æ–≥–∏–∫–∞:**
1. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ: "–£–≤–µ—Ä–µ–Ω—ã?" —Å –∫–Ω–æ–ø–∫–∞–º–∏ [–î–∞] [–ù–µ—Ç]
2. –ü—Ä–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏:
   - `issue.is_archived = True`
   - –û—á–∏—Å—Ç–∫–∞ –ª–æ–≥–æ–≤ –∏–∑ `telegram_logs` –¥–ª—è —ç—Ç–æ–≥–æ issue
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è: "–ó–∞–ø–∏—Å—å –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∞"

---

### 6.7 `telegram_bot.notify_rate_limit(service, remaining)`
**–ó–∞–¥–∞—á–∞:** –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ rate limit

**–õ–æ–≥–∏–∫–∞:**
1. –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: `‚ö†Ô∏è Rate Limit: {service} –æ—Å—Ç–∞–ª–æ—Å—å {remaining}`
2. –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ TG
3. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ `rate_limit_logs`

---

### 6.8 `telegram_bot.notify_critical_error(error)`
**–ó–∞–¥–∞—á–∞:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ

**–õ–æ–≥–∏–∫–∞:**
1. –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: `üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê: {error}`
2. –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ TG
3. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: –ø–æ–ø—ã—Ç–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ email (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ)

---

### 6.9 `telegram_bot.send_daily_digest()`
**–ó–∞–¥–∞—á–∞:** –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –æ—Ç—á—ë—Ç

**–õ–æ–≥–∏–∫–∞:**
1. –°–±–æ—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞:
   - –ù–æ–≤—ã—Ö issue
   - –ó–∞–≤–µ—Ä—à—ë–Ω–Ω—ã—Ö
   - –ó–∞—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤
2. –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫—Ä–∞—Å–∏–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
3. –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ 09:00 (–ø—Ä–æ–≤–µ—Ä–∫–∞ `datetime.utcnow().hour == 9`)

---

## 7. EMAIL MODULE (IMAP –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)

### 7.1 `email_monitor.check_loop()`
**–ó–∞–¥–∞—á–∞:** –ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ—á—Ç—ã

**–õ–æ–≥–∏–∫–∞:**
```
WHILE True:
    TRY:
        check_new_emails()
    EXCEPT:
        log_error()
    
    sleep(600)  # 10 –º–∏–Ω—É—Ç
```

---

### 7.2 `email_monitor.check_new_emails()`
**–ó–∞–¥–∞—á–∞:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–≤—ã—Ö –ø–∏—Å–µ–º –æ—Ç GitHub

**–õ–æ–≥–∏–∫–∞:**
1. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ: `imaplib.IMAP4_SSL(host, port)`
2. `login(email, password)`
3. `select("inbox")`
4. –ü–æ–∏—Å–∫: `search(None, 'UNSEEN FROM "noreply@github.com"')`
5. –î–ª—è –∫–∞–∂–¥–æ–≥–æ ID:
   - `fetch(msg_id, "(RFC822)")`
   - –ü–∞—Ä—Å–∏–Ω–≥ —á–µ—Ä–µ–∑ `email.message_from_bytes()`
   - `process_email(message)`
   - `store(msg_id, '+FLAGS', '\\Seen')` ‚Äî –ø–æ–º–µ—Ç–∏—Ç—å –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–º
6. `logout()`

---

### 7.3 `email_monitor.process_email(message)`
**–ó–∞–¥–∞—á–∞:** –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–¥–Ω–æ–≥–æ –ø–∏—Å—å–º–∞

**–õ–æ–≥–∏–∫–∞:**
1. –î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤: `decode_header()`
2. –ü—Ä–æ–≤–µ—Ä–∫–∞: `subject.contains("merged")` AND `from.contains("github.com")`
3. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–ª–∞: `get_payload(decode=True)`
4. –ï—Å–ª–∏ HTML: `BeautifulSoup.get_text()`
5. –ü–∞—Ä—Å–∏–Ω–≥ PR –Ω–æ–º–µ—Ä–∞: regex `PR\s*#?(\d+)`
6. –ü–æ–∏—Å–∫ PR –≤ –ë–î: `session.query(PullRequest).filter_by(number=...)`
7. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ: `pr.status = 'merged'`, `pr.merged_at = now()`
8. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ analytics: `actual_earned = estimated_bounty`
9. –ü–µ—Ä–µ–≤–æ–¥ –Ω–∞ —Ä—É—Å—Å–∫–∏–π: `translate_to_russian(body)`
10. –í—ã–∑–æ–≤ `telegram.notify_pr_merged()`

---

### 7.4 `email_monitor.translate_to_russian(text)`
**–ó–∞–¥–∞—á–∞:** –ü–µ—Ä–µ–≤–æ–¥ —Ç–µ–∫—Å—Ç–∞ –ø–∏—Å—å–º–∞

**–õ–æ–≥–∏–∫–∞:**
1. –ü—Ä–æ–º–ø—Ç: "–ü–µ—Ä–µ–≤–µ–¥–∏ —Å –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ –Ω–∞ —Ä—É—Å—Å–∫–∏–π, —Å–æ—Ö—Ä–∞–Ω–∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç–µ—Ä–º–∏–Ω—ã"
2. `ai.generate(prompt, max_tokens=1000)`
3. Return –ø–µ—Ä–µ–≤–µ–¥—ë–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç (–æ–±—Ä–µ–∑–∞–Ω–Ω—ã–π –¥–æ 2000 —Å–∏–º–≤–æ–ª–æ–≤ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

---

## 8. DATABASE MODULE (–†–∞–±–æ—Ç–∞ —Å SQLite)

### 8.1 `repository.create_issue(data)`
**–ó–∞–¥–∞—á–∞:** –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ issue

**–õ–æ–≥–∏–∫–∞:**
1. –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ `Issue(**data)`
2. `session.add(issue)`
3. `session.commit()`
4. Return `issue.id`

---

### 8.2 `repository.get_pending_issues()`
**–ó–∞–¥–∞—á–∞:** –ü–æ–ª—É—á–µ–Ω–∏–µ –æ–∂–∏–¥–∞—é—â–∏—Ö issue

**–õ–æ–≥–∏–∫–∞:**
1. `query(Issue).filter_by(status='pending').order_by(Issue.priority.desc())`
2. Return list

---

### 8.3 `repository.update_issue_status(issue_id, status)`
**–ó–∞–¥–∞—á–∞:** –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞

**–õ–æ–≥–∏–∫–∞:**
1. `issue = query(Issue).get(issue_id)`
2. `issue.status = status`
3. `issue.updated_at = now()`
4. `session.commit()`

---

### 8.4 `repository.create_attempt(issue_id, data)`
**–ó–∞–¥–∞—á–∞:** –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ø—ã—Ç–∫–∏

**–õ–æ–≥–∏–∫–∞:**
1. –°–æ–∑–¥–∞–Ω–∏–µ `Attempt(issue_id=issue_id, **data)`
2. `session.add(attempt)`
3. `session.commit()`

---

### 8.5 `analytics.calculate_success_rate()`
**–ó–∞–¥–∞—á–∞:** –†–∞—Å—á—ë—Ç —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏

**–õ–æ–≥–∏–∫–∞:**
1. `total = count(Issue)`
2. `completed = count(status='completed')`
3. `failed = count(status='failed')`
4. Return `completed / total * 100`

---

### 8.6 `analytics.calculate_total_earnings()`
**–ó–∞–¥–∞—á–∞:** –ü–æ–¥—Å—á—ë—Ç –∑–∞—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤

**–õ–æ–≥–∏–∫–∞:**
1. `query(Analytics).filter(Analytics.actual_earned > 0)`
2. `sum(a.actual_earned for a in results)`
3. Return —Å—É–º–º–∞

---

## 9. UTILS (–í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏)

### 9.1 `logger.setup_logging(level, format)`
**–ó–∞–¥–∞—á–∞:** –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

**–õ–æ–≥–∏–∫–∞:**
1. –ï—Å–ª–∏ `format == 'JSON'`:
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `python-json-logger`
   - –°—Ç—Ä—É–∫—Ç—É—Ä–∞: `{"timestamp": "...", "level": "...", "message": "..."}`
2. –ò–Ω–∞—á–µ: —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç
3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ `logging.getLogger()` —Å handlers (file + console)

---

### 9.2 `retry.with_retry(max_attempts, delay)`
**–ó–∞–¥–∞—á–∞:** –î–µ–∫–æ—Ä–∞—Ç–æ—Ä –¥–ª—è retry –ª–æ–≥–∏–∫–∏

**–õ–æ–≥–∏–∫–∞:**
1. –û–±—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
2. –¶–∏–∫–ª `for attempt in range(max_attempts)`:
   - TRY: –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é
   - EXCEPT: sleep(delay), continue
3. –ü–æ—Å–ª–µ –∏—Å—á–µ—Ä–ø–∞–Ω–∏—è –ø–æ–ø—ã—Ç–æ–∫ ‚Äî raise –ø–æ—Å–ª–µ–¥–Ω–µ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ

---

### 9.3 `validators.is_valid_github_url(url)`
**–ó–∞–¥–∞—á–∞:** –í–∞–ª–∏–¥–∞—Ü–∏—è URL GitHub

**–õ–æ–≥–∏–∫–∞:**
1. Regex: `^https://github\.com/[\w-]+/[\w-]+`
2. Return match is not None
## 10. MAIN (–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞)

### 10.1 `main()`
**–ó–∞–¥–∞—á–∞:** –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

**–õ–æ–≥–∏–∫–∞:**
1. `lifespan()` context manager:
   - Startup: `setup_logging()`, `init_db()`, –ª–æ–≥ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è
   - Shutdown: –ª–æ–≥ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è, cleanup
2. –°–æ–∑–¥–∞–Ω–∏–µ `Orchestrator()`
3. `orchestrator.start()`
4. –û–±—Ä–∞–±–æ—Ç–∫–∞ `KeyboardInterrupt` (Ctrl+C)
5. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–π
